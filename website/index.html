<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dandy</title>
    <meta charset="UTF-8">
    <style>
        textarea {
            font-family: monospace;
        }
    </style>
</head>
<body>
Check equivalence of DFA here!
<br>
<label>
    DFA 1:
    <br>
    <textarea id="dfa1" rows="10">
       a  b  c
→ * s₀ s₁ s₀ s₂
    s₁ s₂ s₁ s₁
  * s₂ s₂ s₂ s₂
        </textarea>
</label>
<br>
<label>
    DFA 2:
    <br>
    <textarea id="dfa2" rows="10">
    a b c
→ * x z x y
  * y y y y
    z y a a
    a y z a
        </textarea>
</label>
<br>
<button id="check">Check!</button>
<br>
<span id="errors"></span>

<script type="module">
    import init, {load_dfa, check_dfa_eq} from './web_bindings/dandy_wasm.js';

    async function run() {
        await init();
        document.getElementById("check").onclick = compare;
    }

    function compare() {
        let errors = "";
        let dfa1 = 0, dfa2 = 0;

        try {
            dfa1 = load_dfa(document.getElementById("dfa1").value);
        } catch (e) {
            errors += "Error parsing DFA 1: " + e + "\n";
        }

        try {
            dfa2 = load_dfa(document.getElementById("dfa2").value);
        } catch (e) {
            errors += "Error parsing DFA 2: " + e + "\n";
        }

        if (errors === "") {
            let equal = check_dfa_eq(dfa1, dfa2);
            document.getElementById("check").innerText = equal ? "Equivalent" : "Not equivalent";
        } else {
            document.getElementById("check").innerText = "Fix errors first!";
        }

        document.getElementById("errors").innerText = errors;
    }

    run();
</script>
</body>
</html>